import{b as Ve,l as he,r as p,m as W,j as e,n as fe,P as k,o as ge,p as Me,q as _e,s as De,R as b,c as Y,d as Le,a as Oe,u as Fe,k as $e,t as Be,V as h,I as q,T as se,f as oe,g as re,h as ie,B as le}from"./index--mJaizsc.js";import{u as He,F as qe,a as E,b as K,c as V,d as M,e as Ge}from"./form-CnYccCye.js";import{L as D}from"./label-DparRnXT.js";import{C as Ue,S as ze,a as We,b as Ye,c as Je,d as G}from"./select-DUTwnW6M.js";import{A as Qe,a as Xe,b as Ze,t as et,o as tt,s as U,e as nt}from"./alert-Fao-om9Q.js";import{u as at}from"./use-CR7JZOh1.js";import{c as ct,u as st,S as ot}from"./screen-wrapper-ka0X-mpj.js";import{C as de,a as ue}from"./card-BfKKBDHD.js";import{T as rt,a as it,b as pe,c as me}from"./tabs-DTNzbAxj.js";import{C as lt}from"./circle-alert-CnXNsqva.js";import{I as xe}from"./info-CBKQO1mY.js";import{L as dt}from"./loader-circle-B8TOKiKB.js";import"./index-BdQq_4o_.js";import"./arrow-left-CNAqUfmD.js";/**
 * @license lucide-react v0.469.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ut=Ve("ExternalLink",[["path",{d:"M15 3h6v6",key:"1q9fwt"}],["path",{d:"M10 14 21 3",key:"gplh6r"}],["path",{d:"M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6",key:"a6xqqp"}]]);var J="Collapsible",[pt,be]=he(J),[mt,Q]=pt(J),je=p.forwardRef((t,a)=>{const{__scopeCollapsible:c,open:n,defaultOpen:o,disabled:s,onOpenChange:i,...d}=t,[u=!1,m]=W({prop:n,defaultProp:o,onChange:i});return e.jsx(mt,{scope:c,disabled:s,contentId:fe(),open:u,onOpenToggle:p.useCallback(()=>m(f=>!f),[m]),children:e.jsx(k.div,{"data-state":Z(u),"data-disabled":s?"":void 0,...d,ref:a})})});je.displayName=J;var ye="CollapsibleTrigger",ve=p.forwardRef((t,a)=>{const{__scopeCollapsible:c,...n}=t,o=Q(ye,c);return e.jsx(k.button,{type:"button","aria-controls":o.contentId,"aria-expanded":o.open||!1,"data-state":Z(o.open),"data-disabled":o.disabled?"":void 0,disabled:o.disabled,...n,ref:a,onClick:ge(t.onClick,o.onOpenToggle)})});ve.displayName=ye;var X="CollapsibleContent",Ce=p.forwardRef((t,a)=>{const{forceMount:c,...n}=t,o=Q(X,t.__scopeCollapsible);return e.jsx(Me,{present:c||o.open,children:({present:s})=>e.jsx(xt,{...n,ref:a,present:s})})});Ce.displayName=X;var xt=p.forwardRef((t,a)=>{const{__scopeCollapsible:c,present:n,children:o,...s}=t,i=Q(X,c),[d,u]=p.useState(n),m=p.useRef(null),f=_e(a,m),g=p.useRef(0),v=g.current,C=p.useRef(0),j=C.current,I=i.open||d,A=p.useRef(I),y=p.useRef(void 0);return p.useEffect(()=>{const l=requestAnimationFrame(()=>A.current=!1);return()=>cancelAnimationFrame(l)},[]),De(()=>{const l=m.current;if(l){y.current=y.current||{transitionDuration:l.style.transitionDuration,animationName:l.style.animationName},l.style.transitionDuration="0s",l.style.animationName="none";const _=l.getBoundingClientRect();g.current=_.height,C.current=_.width,A.current||(l.style.transitionDuration=y.current.transitionDuration,l.style.animationName=y.current.animationName),u(n)}},[i.open,n]),e.jsx(k.div,{"data-state":Z(i.open),"data-disabled":i.disabled?"":void 0,id:i.contentId,hidden:!I,...s,ref:f,style:{"--radix-collapsible-content-height":v?`${v}px`:void 0,"--radix-collapsible-content-width":j?`${j}px`:void 0,...t.style},children:I&&o})});function Z(t){return t?"open":"closed"}var ht=je,ft=ve,gt=Ce,P="Accordion",_t=["Home","End","ArrowDown","ArrowUp","ArrowLeft","ArrowRight"],[ee,bt,jt]=ct(P),[B,Yt]=he(P,[jt,be]),te=be(),Ae=b.forwardRef((t,a)=>{const{type:c,...n}=t,o=n,s=n;return e.jsx(ee.Provider,{scope:t.__scopeAccordion,children:c==="multiple"?e.jsx(At,{...s,ref:a}):e.jsx(Ct,{...o,ref:a})})});Ae.displayName=P;var[we,yt]=B(P),[Ne,vt]=B(P,{collapsible:!1}),Ct=b.forwardRef((t,a)=>{const{value:c,defaultValue:n,onValueChange:o=()=>{},collapsible:s=!1,...i}=t,[d,u]=W({prop:c,defaultProp:n,onChange:o});return e.jsx(we,{scope:t.__scopeAccordion,value:d?[d]:[],onItemOpen:u,onItemClose:b.useCallback(()=>s&&u(""),[s,u]),children:e.jsx(Ne,{scope:t.__scopeAccordion,collapsible:s,children:e.jsx(Ie,{...i,ref:a})})})}),At=b.forwardRef((t,a)=>{const{value:c,defaultValue:n,onValueChange:o=()=>{},...s}=t,[i=[],d]=W({prop:c,defaultProp:n,onChange:o}),u=b.useCallback(f=>d((g=[])=>[...g,f]),[d]),m=b.useCallback(f=>d((g=[])=>g.filter(v=>v!==f)),[d]);return e.jsx(we,{scope:t.__scopeAccordion,value:i,onItemOpen:u,onItemClose:m,children:e.jsx(Ne,{scope:t.__scopeAccordion,collapsible:!0,children:e.jsx(Ie,{...s,ref:a})})})}),[wt,H]=B(P),Ie=b.forwardRef((t,a)=>{const{__scopeAccordion:c,disabled:n,dir:o,orientation:s="vertical",...i}=t,d=b.useRef(null),u=_e(d,a),m=bt(c),g=st(o)==="ltr",v=ge(t.onKeyDown,C=>{var x;if(!_t.includes(C.key))return;const j=C.target,I=m().filter(w=>{var N;return!((N=w.ref.current)!=null&&N.disabled)}),A=I.findIndex(w=>w.ref.current===j),y=I.length;if(A===-1)return;C.preventDefault();let l=A;const _=0,S=y-1,T=()=>{l=A+1,l>S&&(l=_)},R=()=>{l=A-1,l<_&&(l=S)};switch(C.key){case"Home":l=_;break;case"End":l=S;break;case"ArrowRight":s==="horizontal"&&(g?T():R());break;case"ArrowDown":s==="vertical"&&T();break;case"ArrowLeft":s==="horizontal"&&(g?R():T());break;case"ArrowUp":s==="vertical"&&R();break}const r=l%y;(x=I[r].ref.current)==null||x.focus()});return e.jsx(wt,{scope:c,disabled:n,direction:o,orientation:s,children:e.jsx(ee.Slot,{scope:c,children:e.jsx(k.div,{...i,"data-orientation":s,ref:u,onKeyDown:n?void 0:v})})})}),$="AccordionItem",[Nt,ne]=B($),Pe=b.forwardRef((t,a)=>{const{__scopeAccordion:c,value:n,...o}=t,s=H($,c),i=yt($,c),d=te(c),u=fe(),m=n&&i.value.includes(n)||!1,f=s.disabled||t.disabled;return e.jsx(Nt,{scope:c,open:m,disabled:f,triggerId:u,children:e.jsx(ht,{"data-orientation":s.orientation,"data-state":Ke(m),...d,...o,ref:a,disabled:f,open:m,onOpenChange:g=>{g?i.onItemOpen(n):i.onItemClose(n)}})})});Pe.displayName=$;var Se="AccordionHeader",Re=b.forwardRef((t,a)=>{const{__scopeAccordion:c,...n}=t,o=H(P,c),s=ne(Se,c);return e.jsx(k.h3,{"data-orientation":o.orientation,"data-state":Ke(s.open),"data-disabled":s.disabled?"":void 0,...n,ref:a})});Re.displayName=Se;var z="AccordionTrigger",Te=b.forwardRef((t,a)=>{const{__scopeAccordion:c,...n}=t,o=H(P,c),s=ne(z,c),i=vt(z,c),d=te(c);return e.jsx(ee.ItemSlot,{scope:c,children:e.jsx(ft,{"aria-disabled":s.open&&!i.collapsible||void 0,"data-orientation":o.orientation,id:s.triggerId,...d,...n,ref:a})})});Te.displayName=z;var ke="AccordionContent",Ee=b.forwardRef((t,a)=>{const{__scopeAccordion:c,...n}=t,o=H(P,c),s=ne(ke,c),i=te(c);return e.jsx(gt,{role:"region","aria-labelledby":s.triggerId,"data-orientation":o.orientation,...i,...n,ref:a,style:{"--radix-accordion-content-height":"var(--radix-collapsible-content-height)","--radix-accordion-content-width":"var(--radix-collapsible-content-width)",...t.style}})});Ee.displayName=ke;function Ke(t){return t?"open":"closed"}var It=Ae,Pt=Pe,St=Re,Rt=Te,Tt=Ee;const kt=It,L=p.forwardRef(({className:t,...a},c)=>e.jsx(Pt,{ref:c,className:Y("border-b",t),...a}));L.displayName="AccordionItem";const O=p.forwardRef(({className:t,children:a,...c},n)=>e.jsx(St,{className:"flex",children:e.jsxs(Rt,{ref:n,className:Y("flex flex-1 items-center justify-between py-4 font-medium transition-all hover:underline [&[data-state=open]>svg]:rotate-180",t),...c,children:[a,e.jsx(Ue,{className:"h-4 w-4 shrink-0 transition-transform duration-200"})]})}));O.displayName="AccordionTrigger";const F=p.forwardRef(({className:t,children:a,...c},n)=>e.jsx(Tt,{ref:n,className:"overflow-hidden text-sm transition-all data-[state=closed]:animate-accordion-up data-[state=open]:animate-accordion-down",...c,children:e.jsx("div",{className:Y("pb-4 pt-0",t),children:a})}));F.displayName="AccordionContent";const Et=tt({exchange:nt(["bybit","binance","bitget"]),name:U().min(1),apiKey:U().min(1),secretKey:U().min(1)}),Kt=t=>({bybit:{title:t("account.bybit_api_guide"),url:"https://www.bybit.com/app/user/api-management",steps:[t("account.bybit_step_1","Bybit 계정에 로그인합니다."),t("account.bybit_step_2","우측 상단의 프로필 아이콘을 클릭한 후 'API Management'를 선택합니다."),t("account.bybit_step_3","'Create New Key'를 클릭합니다."),t("account.bybit_step_4","키 이름을 입력하고 읽기 및 거래 권한을 선택합니다."),t("account.bybit_step_5","보안 인증을 완료하고 키를 생성합니다."),t("account.bybit_step_6","API 키와 Secret 키를 저장하고 이 앱에 입력합니다.")]},binance:{title:t("account.binance_api_guide"),url:"https://www.binance.com/en/my/settings/api-management",steps:[t("account.binance_step_1","Binance 계정에 로그인합니다."),t("account.binance_step_2","'API Management'로 이동합니다."),t("account.binance_step_3","'Create API'를 클릭합니다."),t("account.binance_step_4","보안 인증을 완료하고 API 이름을 입력합니다."),t("account.binance_step_5","필요한 권한을 선택하고 API 키를 생성합니다."),t("account.binance_step_6","API 키와 Secret 키를 저장하고 이 앱에 입력합니다.")]},bitget:{title:t("account.bitget_api_guide"),url:"https://www.bitget.com/en/account/apiManagement",steps:[t("account.bitget_step_1","Bitget 계정에 로그인합니다."),t("account.bitget_step_2","'My Account' > 'API Management'로 이동합니다."),t("account.bitget_step_3","'Create API'를 클릭합니다."),t("account.bitget_step_4","API 이름과 권한을 설정합니다."),t("account.bitget_step_5","보안 인증을 완료하고 키를 생성합니다."),t("account.bitget_step_6","API 키와 Secret 키를 저장하고 이 앱에 입력합니다.")]}}),Jt=()=>{var R;const{t}=Le(),a=He({resolver:et(Et),defaultValues:{exchange:"bybit",name:"",apiKey:"",secretKey:""}}),c=Oe(),{cache:n,updateCache:o}=Fe(),{trackEvent:s}=$e(),[i,d]=Be(),u=i.get("exchange"),{addNewAccount:m,refreshAccounts:f,validateAccount:g}=at(),[v,C]=p.useState(!1),[j,I]=p.useState(!0),[A,y]=p.useState(null),l=(R=n==null?void 0:n.data)==null?void 0:R.exchange,_=a.watch("exchange")||"bybit",S=Kt(t),T=async r=>{C(!0),y(null);const x=h.loading(t("account.validating_api_key"));try{if(await g({exchange:r.exchange,apikey:r.apiKey,secret:r.secretKey})){h.dismiss(x),h.loading(t("account.adding_account"));const N=await m({exchange:r.exchange,name:r.name,apiKey:r.apiKey,secretKey:r.secretKey});if(N&&N.success){s({action:"account_added",category:"account_management",label:r.exchange,name:r.name}),h.dismiss(),h.success(t("account.account_added_success",{name:r.name})),await f();const ae=sessionStorage.getItem("returnToTradeScreen");if(ae){sessionStorage.removeItem("returnToTradeScreen");const ce=new URLSearchParams(ae);N.id&&ce.set("id",N.id),c(`/trade?${ce.toString()}`)}else c("/search")}else throw new Error(t("account.adding_account_error"))}else s({action:"account_validation",category:"account_management",label:"failed",exchange:r.exchange}),h.dismiss(x),h.error(t("account.api_validation_failed")),y(t("account.check_api_key_valid"))}catch(w){console.error(w),h.dismiss(x),h.error(t("account.adding_account_error")),y(t("account.check_input_info")),a.setValue("apiKey",""),a.setValue("secretKey","")}finally{C(!1)}};return p.useEffect(()=>{j&&(n!=null&&n.data)&&(a.setValue("exchange",n.data.exchange),a.setValue("name",n.data.name||""),a.setValue("apiKey",n.data.apiKey||""),a.setValue("secretKey",n.data.secretKey||""),u&&u!==n.data.exchange?(a.setValue("exchange",u),o({...n,data:{...n.data,exchange:u}})):n.data.exchange&&d({exchange:n.data.exchange}),I(!1))},[j,a,n,u,d,o]),p.useEffect(()=>{const r=a.watch(x=>{if(n&&!j&&x){const w=setTimeout(()=>{o({...n,data:x})},300);return()=>clearTimeout(w)}});return()=>r.unsubscribe()},[n,j,a,o]),p.useEffect(()=>{!j&&_&&(h.dismiss(),h.success(t("account.exchange_selected",{exchange:String(_).toUpperCase()}),{duration:1500,icon:"🔄"}))},[_,j,t]),e.jsx(ot,{headerProps:{title:t("account.add_account")},children:e.jsxs(rt,{defaultValue:"form",className:"w-full",children:[e.jsxs(it,{className:"w-full mb-4",children:[e.jsx(pe,{value:"form",className:"flex-1",children:t("account.account_info")}),e.jsx(pe,{value:"guide",className:"flex-1",children:t("account.api_setting_guide")})]}),e.jsx(me,{value:"form",className:"space-y-4",children:e.jsx(de,{children:e.jsxs(ue,{className:"pt-6",children:[e.jsxs("div",{className:"mb-6",children:[e.jsx("h2",{className:"text-xl font-semibold",children:t("account.api_key_setting")}),e.jsx("p",{className:"text-sm text-muted-foreground mt-1",children:t("account.api_key_encrypted")})]}),A&&e.jsxs(Qe,{variant:"destructive",className:"mb-4",children:[e.jsx(lt,{className:"h-4 w-4"}),e.jsx(Xe,{children:t("common.error")}),e.jsx(Ze,{children:A})]}),e.jsx(qe,{...a,children:e.jsxs("form",{onSubmit:a.handleSubmit(T),className:"space-y-4",children:[e.jsx(E,{control:a.control,name:"exchange",render:({field:r})=>e.jsxs(K,{children:[e.jsx(D,{htmlFor:"exchange",children:t("account.exchange")}),e.jsxs(ze,{value:r.value,onValueChange:x=>{r.onChange(x),d(w=>{const N=new URLSearchParams(w);return N.set("exchange",x),N})},defaultValue:u||l,children:[e.jsx(V,{children:e.jsx(We,{id:"exchange",children:e.jsx(Ye,{placeholder:t("account.select_exchange")})})}),e.jsxs(Je,{position:"popper",children:[e.jsx(G,{value:"bybit",children:"Bybit"}),e.jsx(G,{value:"binance",children:"Binance"}),e.jsx(G,{value:"bitget",children:"Bitget"})]})]}),e.jsx(M,{})]})}),e.jsx(E,{control:a.control,name:"name",render:({field:r})=>e.jsxs(K,{children:[e.jsx(D,{htmlFor:"name",children:t("account.account_name")}),e.jsx(V,{children:e.jsx(q,{...r,id:"name",placeholder:t("account.enter_account_name"),onBlur:()=>{r.value&&h(`'${r.value}' ${t("account.name_set_message","이름으로 계정이 설정됩니다")}`,{icon:"📝",duration:1500})}})}),e.jsx(Ge,{children:t("account.account_to_distinguish")}),e.jsx(M,{})]})}),e.jsx(E,{control:a.control,name:"apiKey",render:({field:r})=>e.jsxs(K,{children:[e.jsxs(D,{htmlFor:"apiKey",className:"flex items-center gap-1",children:[t("account.api_key"),e.jsx(se,{children:e.jsxs(oe,{children:[e.jsx(re,{children:e.jsx(xe,{className:"h-4 w-4 text-muted-foreground"})}),e.jsx(ie,{children:t("account.api_key_tooltip")})]})})]}),e.jsx(V,{children:e.jsx(q,{...r,id:"apiKey",placeholder:t("account.api_key_tooltip")})}),e.jsx(M,{})]})}),e.jsx(E,{control:a.control,name:"secretKey",render:({field:r})=>e.jsxs(K,{children:[e.jsxs(D,{htmlFor:"secretKey",className:"flex items-center gap-1",children:[t("account.api_secret"),e.jsx(se,{children:e.jsxs(oe,{children:[e.jsx(re,{children:e.jsx(xe,{className:"h-4 w-4 text-muted-foreground"})}),e.jsx(ie,{children:t("account.secret_key_tooltip")})]})})]}),e.jsx(V,{children:e.jsx(q,{...r,id:"secretKey",type:"password",placeholder:t("account.api_secret")})}),e.jsx(M,{})]})}),e.jsxs("div",{className:"flex justify-center pt-4 w-full gap-4",children:[e.jsx(le,{className:"w-full md:w-40",disabled:v,variant:"outline",onClick:()=>{h.success(t("account.operation_cancelled"),{icon:"✖️",duration:1500}),c(-1)},type:"button",children:t("common.cancel")}),e.jsx(le,{className:"w-full md:w-40",disabled:v,type:"submit",children:v?e.jsxs(e.Fragment,{children:[e.jsx(dt,{className:"mr-2 h-4 w-4 animate-spin"}),t("account.verifying")]}):t("common.save")})]})]})})]})})}),e.jsx(me,{value:"guide",children:e.jsx(de,{children:e.jsxs(ue,{className:"pt-6",children:[e.jsxs("div",{className:"mb-4",children:[e.jsx("h2",{className:"text-xl font-semibold",children:S[_].title}),e.jsxs("a",{href:S[_].url,target:"_blank",rel:"noopener noreferrer",className:"text-sm text-blue-500 flex items-center mt-1 hover:underline",onClick:()=>{h.success(t("account.go_to_exchange_api"),{icon:"🔗",duration:2e3})},children:[t("account.go_to_exchange_api"),e.jsx(ut,{className:"ml-1 h-3 w-3"})]})]}),e.jsxs(kt,{type:"single",collapsible:!0,defaultValue:"steps",children:[e.jsxs(L,{value:"steps",children:[e.jsx(O,{children:t("account.api_key_setup_method")}),e.jsx(F,{children:e.jsx("ol",{className:"list-decimal pl-5 space-y-2",children:S[_].steps.map((r,x)=>e.jsx("li",{children:r},x))})})]}),e.jsxs(L,{value:"permissions",children:[e.jsx(O,{children:t("account.required_api_permissions")}),e.jsxs(F,{children:[e.jsx("p",{children:t("account.api_permissions_needed","이 앱은 다음과 같은 API 권한이 필요합니다:")}),e.jsxs("ul",{className:"list-disc pl-5 mt-2 space-y-1",children:[e.jsx("li",{children:t("account.account_info_permission")}),e.jsx("li",{children:t("account.balance_permission")}),e.jsx("li",{children:t("account.trading_permission")})]}),e.jsx("div",{className:"mt-3 p-3 bg-yellow-50 dark:bg-yellow-950 rounded-md",children:e.jsx("p",{className:"text-yellow-800 dark:text-yellow-200 text-sm",children:t("account.security_withdrawal_warning")})})]})]}),e.jsxs(L,{value:"security",children:[e.jsx(O,{children:t("account.security_tips")}),e.jsx(F,{children:e.jsxs("ul",{className:"list-disc pl-5 space-y-2",children:[e.jsx("li",{children:t("account.security_tip_1","API 키는 다른 사람과 공유하지 마세요.")}),e.jsx("li",{children:t("account.security_tip_2","필요한 권한만 부여하세요.")}),e.jsx("li",{children:t("account.security_tip_3","IP 제한을 설정하여 보안을 강화하세요.")}),e.jsx("li",{children:t("account.security_tip_4","주기적으로 API 키를 변경하는 것이 좋습니다.")}),e.jsx("li",{children:t("account.security_tip_5","의심스러운 활동이 발견되면 즉시 API 키를 비활성화하세요.")})]})})]})]})]})})})]})})};export{Jt as default};
