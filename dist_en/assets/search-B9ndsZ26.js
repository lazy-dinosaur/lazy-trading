import{b as F,d as R,j as r,I as de,r as d,l as ue,P as $,J as me,s as H,c as D,L as fe,a as ge,M as xe,D as N}from"./index--mJaizsc.js";import{S as pe}from"./screen-wrapper-ka0X-mpj.js";import{u as be,a as ve}from"./coin-BD38kp2d.js";import{S as we,a as ye,b as Se,c as je,e as Ce,d as _}from"./select-DUTwnW6M.js";import{C as q,a as G}from"./card-BfKKBDHD.js";import{T as Ne,a as Ee,b as W}from"./tabs-DTNzbAxj.js";import"./arrow-left-CNAqUfmD.js";import"./index-BdQq_4o_.js";/**
 * @license lucide-react v0.469.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Me=F("ArrowDown",[["path",{d:"M12 5v14",key:"s699le"}],["path",{d:"m19 12-7 7-7-7",key:"1idqje"}]]);/**
 * @license lucide-react v0.469.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ie=F("ArrowUpDown",[["path",{d:"m21 16-4 4-4-4",key:"f6ql7i"}],["path",{d:"M17 20V4",key:"1ejh1v"}],["path",{d:"m3 8 4-4 4 4",key:"11wl7u"}],["path",{d:"M7 4v16",key:"1glfcx"}]]);/**
 * @license lucide-react v0.469.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ze=F("ArrowUp",[["path",{d:"m5 12 7-7 7 7",key:"hav0vg"}],["path",{d:"M12 19V5",key:"x0mq9r"}]]);/**
 * @license lucide-react v0.469.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Oe=F("Star",[["path",{d:"M11.525 2.295a.53.53 0 0 1 .95 0l2.31 4.679a2.123 2.123 0 0 0 1.595 1.16l5.166.756a.53.53 0 0 1 .294.904l-3.736 3.638a2.123 2.123 0 0 0-.611 1.878l.882 5.14a.53.53 0 0 1-.771.56l-4.618-2.428a2.122 2.122 0 0 0-1.973 0L6.396 21.01a.53.53 0 0 1-.77-.56l.881-5.139a2.122 2.122 0 0 0-.611-1.879L2.16 9.795a.53.53 0 0 1 .294-.906l5.165-.755a2.122 2.122 0 0 0 1.597-1.16z",key:"r04s7s"}]]),Te=({onSearch:l,onExchangeFilter:o,searchQuery:e,exchangeFilter:s})=>{const{t}=R();return r.jsxs("div",{className:"flex items-center w-full gap-2 p-2 bg-background border-b",children:[r.jsx(de,{placeholder:t("search.search_example"),value:e,onChange:i=>l(i.target.value),className:"max-full h-6 h-lg:h-8 h-xl:h-10 flex-1"}),r.jsxs(we,{value:s||"all",onValueChange:i=>{o(i==="all"?null:i)},children:[r.jsx(ye,{className:"w-40 h-6 h-lg:h-8 h-xl:h-10",children:r.jsx(Se,{placeholder:t("search.exchange")})}),r.jsx(je,{children:r.jsxs(Ce,{children:[r.jsx(_,{value:"all",children:t("search.all")}),r.jsx(_,{value:"bybit",children:t("search.bybit")}),r.jsx(_,{value:"binance",children:t("search.binance")}),r.jsx(_,{value:"bitget",children:t("search.bitget")})]})})]})]})};var V="Avatar",[Ae,ot]=ue(V),[ke,J]=Ae(V),Q=d.forwardRef((l,o)=>{const{__scopeAvatar:e,...s}=l,[t,i]=d.useState("idle");return r.jsx(ke,{scope:e,imageLoadingStatus:t,onImageLoadingStatusChange:i,children:r.jsx($.span,{...s,ref:o})})});Q.displayName=V;var X="AvatarImage",Y=d.forwardRef((l,o)=>{const{__scopeAvatar:e,src:s,onLoadingStatusChange:t=()=>{},...i}=l,n=J(X,e),a=_e(s,i.referrerPolicy),c=me(u=>{t(u),n.onImageLoadingStatusChange(u)});return H(()=>{a!=="idle"&&c(a)},[a,c]),a==="loaded"?r.jsx($.img,{...i,ref:o,src:s}):null});Y.displayName=X;var Z="AvatarFallback",ee=d.forwardRef((l,o)=>{const{__scopeAvatar:e,delayMs:s,...t}=l,i=J(Z,e),[n,a]=d.useState(s===void 0);return d.useEffect(()=>{if(s!==void 0){const c=window.setTimeout(()=>a(!0),s);return()=>window.clearTimeout(c)}},[s]),n&&i.imageLoadingStatus!=="loaded"?r.jsx($.span,{...t,ref:o}):null});ee.displayName=Z;function _e(l,o){const[e,s]=d.useState("idle");return H(()=>{if(!l){s("error");return}let t=!0;const i=new window.Image,n=a=>()=>{t&&s(a)};return s("loading"),i.onload=n("loaded"),i.onerror=n("error"),i.src=l,o&&(i.referrerPolicy=o),()=>{t=!1}},[l,o]),e}var te=Q,se=Y,ne=ee;const re=d.forwardRef(({className:l,...o},e)=>r.jsx(te,{ref:e,className:D("relative flex h-10 w-10 shrink-0 overflow-hidden rounded-full",l),...o}));re.displayName=te.displayName;const ie=d.forwardRef(({className:l,...o},e)=>r.jsx(se,{ref:e,className:D("aspect-square h-full w-full",l),...o}));ie.displayName=se.displayName;const le=d.forwardRef(({className:l,...o},e)=>r.jsx(ne,{ref:e,className:D("flex h-full w-full items-center justify-center rounded-full bg-zinc-100 dark:bg-zinc-800",l),...o}));le.displayName=ne.displayName;function z(l,o,e){let s=e.initialDeps??[],t;return()=>{var i,n,a,c;let u;e.key&&((i=e.debug)!=null&&i.call(e))&&(u=Date.now());const m=l();if(!(m.length!==s.length||m.some((v,y)=>s[y]!==v)))return t;s=m;let b;if(e.key&&((n=e.debug)!=null&&n.call(e))&&(b=Date.now()),t=o(...m),e.key&&((a=e.debug)!=null&&a.call(e))){const v=Math.round((Date.now()-u)*100)/100,y=Math.round((Date.now()-b)*100)/100,E=y/16,h=(f,M)=>{for(f=String(f);f.length<M;)f=" "+f;return f};console.info(`%c⏱ ${h(y,5)} /${h(v,5)} ms`,`
            font-size: .6rem;
            font-weight: bold;
            color: hsl(${Math.max(0,Math.min(120-120*E,120))}deg 100% 31%);`,e==null?void 0:e.key)}return(c=e==null?void 0:e.onChange)==null||c.call(e,t),t}}function L(l,o){if(l===void 0)throw new Error("Unexpected undefined");return l}const Fe=(l,o)=>Math.abs(l-o)<1,Re=(l,o,e)=>{let s;return function(...t){l.clearTimeout(s),s=l.setTimeout(()=>o.apply(this,t),e)}},Le=l=>l,$e=l=>{const o=Math.max(l.startIndex-l.overscan,0),e=Math.min(l.endIndex+l.overscan,l.count-1),s=[];for(let t=o;t<=e;t++)s.push(t);return s},De=(l,o)=>{const e=l.scrollElement;if(!e)return;const s=l.targetWindow;if(!s)return;const t=n=>{const{width:a,height:c}=n;o({width:Math.round(a),height:Math.round(c)})};if(t(e.getBoundingClientRect()),!s.ResizeObserver)return()=>{};const i=new s.ResizeObserver(n=>{const a=()=>{const c=n[0];if(c!=null&&c.borderBoxSize){const u=c.borderBoxSize[0];if(u){t({width:u.inlineSize,height:u.blockSize});return}}t(e.getBoundingClientRect())};l.options.useAnimationFrameWithResizeObserver?requestAnimationFrame(a):a()});return i.observe(e,{box:"border-box"}),()=>{i.unobserve(e)}},P={passive:!0},B=typeof window>"u"?!0:"onscrollend"in window,Ve=(l,o)=>{const e=l.scrollElement;if(!e)return;const s=l.targetWindow;if(!s)return;let t=0;const i=l.options.useScrollendEvent&&B?()=>{}:Re(s,()=>{o(t,!1)},l.options.isScrollingResetDelay),n=m=>()=>{const{horizontal:p,isRtl:b}=l.options;t=p?e.scrollLeft*(b&&-1||1):e.scrollTop,i(),o(t,m)},a=n(!0),c=n(!1);c(),e.addEventListener("scroll",a,P);const u=l.options.useScrollendEvent&&B;return u&&e.addEventListener("scrollend",c,P),()=>{e.removeEventListener("scroll",a),u&&e.removeEventListener("scrollend",c)}},We=(l,o,e)=>{if(o!=null&&o.borderBoxSize){const s=o.borderBoxSize[0];if(s)return Math.round(s[e.options.horizontal?"inlineSize":"blockSize"])}return Math.round(l.getBoundingClientRect()[e.options.horizontal?"width":"height"])},Pe=(l,{adjustments:o=0,behavior:e},s)=>{var t,i;const n=l+o;(i=(t=s.scrollElement)==null?void 0:t.scrollTo)==null||i.call(t,{[s.options.horizontal?"left":"top"]:n,behavior:e})};class Be{constructor(o){this.unsubs=[],this.scrollElement=null,this.targetWindow=null,this.isScrolling=!1,this.scrollToIndexTimeoutId=null,this.measurementsCache=[],this.itemSizeCache=new Map,this.pendingMeasuredCacheIndexes=[],this.scrollRect=null,this.scrollOffset=null,this.scrollDirection=null,this.scrollAdjustments=0,this.elementsCache=new Map,this.observer=(()=>{let e=null;const s=()=>e||(!this.targetWindow||!this.targetWindow.ResizeObserver?null:e=new this.targetWindow.ResizeObserver(t=>{t.forEach(i=>{const n=()=>{this._measureElement(i.target,i)};this.options.useAnimationFrameWithResizeObserver?requestAnimationFrame(n):n()})}));return{disconnect:()=>{var t;(t=s())==null||t.disconnect(),e=null},observe:t=>{var i;return(i=s())==null?void 0:i.observe(t,{box:"border-box"})},unobserve:t=>{var i;return(i=s())==null?void 0:i.unobserve(t)}}})(),this.range=null,this.setOptions=e=>{Object.entries(e).forEach(([s,t])=>{typeof t>"u"&&delete e[s]}),this.options={debug:!1,initialOffset:0,overscan:1,paddingStart:0,paddingEnd:0,scrollPaddingStart:0,scrollPaddingEnd:0,horizontal:!1,getItemKey:Le,rangeExtractor:$e,onChange:()=>{},measureElement:We,initialRect:{width:0,height:0},scrollMargin:0,gap:0,indexAttribute:"data-index",initialMeasurementsCache:[],lanes:1,isScrollingResetDelay:150,enabled:!0,isRtl:!1,useScrollendEvent:!0,useAnimationFrameWithResizeObserver:!1,...e}},this.notify=e=>{var s,t;(t=(s=this.options).onChange)==null||t.call(s,this,e)},this.maybeNotify=z(()=>(this.calculateRange(),[this.isScrolling,this.range?this.range.startIndex:null,this.range?this.range.endIndex:null]),e=>{this.notify(e)},{key:!1,debug:()=>this.options.debug,initialDeps:[this.isScrolling,this.range?this.range.startIndex:null,this.range?this.range.endIndex:null]}),this.cleanup=()=>{this.unsubs.filter(Boolean).forEach(e=>e()),this.unsubs=[],this.observer.disconnect(),this.scrollElement=null,this.targetWindow=null},this._didMount=()=>()=>{this.cleanup()},this._willUpdate=()=>{var e;const s=this.options.enabled?this.options.getScrollElement():null;if(this.scrollElement!==s){if(this.cleanup(),!s){this.maybeNotify();return}this.scrollElement=s,this.scrollElement&&"ownerDocument"in this.scrollElement?this.targetWindow=this.scrollElement.ownerDocument.defaultView:this.targetWindow=((e=this.scrollElement)==null?void 0:e.window)??null,this.elementsCache.forEach(t=>{this.observer.observe(t)}),this._scrollToOffset(this.getScrollOffset(),{adjustments:void 0,behavior:void 0}),this.unsubs.push(this.options.observeElementRect(this,t=>{this.scrollRect=t,this.maybeNotify()})),this.unsubs.push(this.options.observeElementOffset(this,(t,i)=>{this.scrollAdjustments=0,this.scrollDirection=i?this.getScrollOffset()<t?"forward":"backward":null,this.scrollOffset=t,this.isScrolling=i,this.maybeNotify()}))}},this.getSize=()=>this.options.enabled?(this.scrollRect=this.scrollRect??this.options.initialRect,this.scrollRect[this.options.horizontal?"width":"height"]):(this.scrollRect=null,0),this.getScrollOffset=()=>this.options.enabled?(this.scrollOffset=this.scrollOffset??(typeof this.options.initialOffset=="function"?this.options.initialOffset():this.options.initialOffset),this.scrollOffset):(this.scrollOffset=null,0),this.getFurthestMeasurement=(e,s)=>{const t=new Map,i=new Map;for(let n=s-1;n>=0;n--){const a=e[n];if(t.has(a.lane))continue;const c=i.get(a.lane);if(c==null||a.end>c.end?i.set(a.lane,a):a.end<c.end&&t.set(a.lane,!0),t.size===this.options.lanes)break}return i.size===this.options.lanes?Array.from(i.values()).sort((n,a)=>n.end===a.end?n.index-a.index:n.end-a.end)[0]:void 0},this.getMeasurementOptions=z(()=>[this.options.count,this.options.paddingStart,this.options.scrollMargin,this.options.getItemKey,this.options.enabled],(e,s,t,i,n)=>(this.pendingMeasuredCacheIndexes=[],{count:e,paddingStart:s,scrollMargin:t,getItemKey:i,enabled:n}),{key:!1}),this.getMeasurements=z(()=>[this.getMeasurementOptions(),this.itemSizeCache],({count:e,paddingStart:s,scrollMargin:t,getItemKey:i,enabled:n},a)=>{if(!n)return this.measurementsCache=[],this.itemSizeCache.clear(),[];this.measurementsCache.length===0&&(this.measurementsCache=this.options.initialMeasurementsCache,this.measurementsCache.forEach(m=>{this.itemSizeCache.set(m.key,m.size)}));const c=this.pendingMeasuredCacheIndexes.length>0?Math.min(...this.pendingMeasuredCacheIndexes):0;this.pendingMeasuredCacheIndexes=[];const u=this.measurementsCache.slice(0,c);for(let m=c;m<e;m++){const p=i(m),b=this.options.lanes===1?u[m-1]:this.getFurthestMeasurement(u,m),v=b?b.end+this.options.gap:s+t,y=a.get(p),E=typeof y=="number"?y:this.options.estimateSize(m),h=v+E,f=b?b.lane:m%this.options.lanes;u[m]={index:m,start:v,size:E,end:h,key:p,lane:f}}return this.measurementsCache=u,u},{key:!1,debug:()=>this.options.debug}),this.calculateRange=z(()=>[this.getMeasurements(),this.getSize(),this.getScrollOffset()],(e,s,t)=>this.range=e.length>0&&s>0?Ke({measurements:e,outerSize:s,scrollOffset:t}):null,{key:!1,debug:()=>this.options.debug}),this.getVirtualIndexes=z(()=>{let e=null,s=null;const t=this.calculateRange();return t&&(e=t.startIndex,s=t.endIndex),[this.options.rangeExtractor,this.options.overscan,this.options.count,e,s]},(e,s,t,i,n)=>i===null||n===null?[]:e({startIndex:i,endIndex:n,overscan:s,count:t}),{key:!1,debug:()=>this.options.debug}),this.indexFromElement=e=>{const s=this.options.indexAttribute,t=e.getAttribute(s);return t?parseInt(t,10):(console.warn(`Missing attribute name '${s}={index}' on measured element.`),-1)},this._measureElement=(e,s)=>{const t=this.indexFromElement(e),i=this.measurementsCache[t];if(!i)return;const n=i.key,a=this.elementsCache.get(n);a!==e&&(a&&this.observer.unobserve(a),this.observer.observe(e),this.elementsCache.set(n,e)),e.isConnected&&this.resizeItem(t,this.options.measureElement(e,s,this))},this.resizeItem=(e,s)=>{const t=this.measurementsCache[e];if(!t)return;const i=this.itemSizeCache.get(t.key)??t.size,n=s-i;n!==0&&((this.shouldAdjustScrollPositionOnItemSizeChange!==void 0?this.shouldAdjustScrollPositionOnItemSizeChange(t,n,this):t.start<this.getScrollOffset()+this.scrollAdjustments)&&this._scrollToOffset(this.getScrollOffset(),{adjustments:this.scrollAdjustments+=n,behavior:void 0}),this.pendingMeasuredCacheIndexes.push(t.index),this.itemSizeCache=new Map(this.itemSizeCache.set(t.key,s)),this.notify(!1))},this.measureElement=e=>{if(!e){this.elementsCache.forEach((s,t)=>{s.isConnected||(this.observer.unobserve(s),this.elementsCache.delete(t))});return}this._measureElement(e,void 0)},this.getVirtualItems=z(()=>[this.getVirtualIndexes(),this.getMeasurements()],(e,s)=>{const t=[];for(let i=0,n=e.length;i<n;i++){const a=e[i],c=s[a];t.push(c)}return t},{key:!1,debug:()=>this.options.debug}),this.getVirtualItemForOffset=e=>{const s=this.getMeasurements();if(s.length!==0)return L(s[ae(0,s.length-1,t=>L(s[t]).start,e)])},this.getOffsetForAlignment=(e,s)=>{const t=this.getSize(),i=this.getScrollOffset();s==="auto"&&e>=i+t&&(s="end"),s==="end"&&(e-=t);const n=this.options.horizontal?"scrollWidth":"scrollHeight",c=(this.scrollElement?"document"in this.scrollElement?this.scrollElement.document.documentElement[n]:this.scrollElement[n]:0)-t;return Math.max(Math.min(c,e),0)},this.getOffsetForIndex=(e,s="auto")=>{e=Math.max(0,Math.min(e,this.options.count-1));const t=this.measurementsCache[e];if(!t)return;const i=this.getSize(),n=this.getScrollOffset();if(s==="auto")if(t.end>=n+i-this.options.scrollPaddingEnd)s="end";else if(t.start<=n+this.options.scrollPaddingStart)s="start";else return[n,s];const a=t.start-this.options.scrollPaddingStart+(t.size-i)/2;switch(s){case"center":return[this.getOffsetForAlignment(a,s),s];case"end":return[this.getOffsetForAlignment(t.end+this.options.scrollPaddingEnd,s),s];default:return[this.getOffsetForAlignment(t.start-this.options.scrollPaddingStart,s),s]}},this.isDynamicMode=()=>this.elementsCache.size>0,this.cancelScrollToIndex=()=>{this.scrollToIndexTimeoutId!==null&&this.targetWindow&&(this.targetWindow.clearTimeout(this.scrollToIndexTimeoutId),this.scrollToIndexTimeoutId=null)},this.scrollToOffset=(e,{align:s="start",behavior:t}={})=>{this.cancelScrollToIndex(),t==="smooth"&&this.isDynamicMode()&&console.warn("The `smooth` scroll behavior is not fully supported with dynamic size."),this._scrollToOffset(this.getOffsetForAlignment(e,s),{adjustments:void 0,behavior:t})},this.scrollToIndex=(e,{align:s="auto",behavior:t}={})=>{e=Math.max(0,Math.min(e,this.options.count-1)),this.cancelScrollToIndex(),t==="smooth"&&this.isDynamicMode()&&console.warn("The `smooth` scroll behavior is not fully supported with dynamic size.");const i=this.getOffsetForIndex(e,s);if(!i)return;const[n,a]=i;this._scrollToOffset(n,{adjustments:void 0,behavior:t}),t!=="smooth"&&this.isDynamicMode()&&this.targetWindow&&(this.scrollToIndexTimeoutId=this.targetWindow.setTimeout(()=>{if(this.scrollToIndexTimeoutId=null,this.elementsCache.has(this.options.getItemKey(e))){const[u]=L(this.getOffsetForIndex(e,a));Fe(u,this.getScrollOffset())||this.scrollToIndex(e,{align:a,behavior:t})}else this.scrollToIndex(e,{align:a,behavior:t})}))},this.scrollBy=(e,{behavior:s}={})=>{this.cancelScrollToIndex(),s==="smooth"&&this.isDynamicMode()&&console.warn("The `smooth` scroll behavior is not fully supported with dynamic size."),this._scrollToOffset(this.getScrollOffset()+e,{adjustments:void 0,behavior:s})},this.getTotalSize=()=>{var e;const s=this.getMeasurements();let t;return s.length===0?t=this.options.paddingStart:t=this.options.lanes===1?((e=s[s.length-1])==null?void 0:e.end)??0:Math.max(...s.slice(-this.options.lanes).map(i=>i.end)),Math.max(t-this.options.scrollMargin+this.options.paddingEnd,0)},this._scrollToOffset=(e,{adjustments:s,behavior:t})=>{this.options.scrollToFn(e,{behavior:t,adjustments:s},this)},this.measure=()=>{this.itemSizeCache=new Map,this.notify(!1)},this.setOptions(o)}}const ae=(l,o,e,s)=>{for(;l<=o;){const t=(l+o)/2|0,i=e(t);if(i<s)l=t+1;else if(i>s)o=t-1;else return t}return l>0?l-1:0};function Ke({measurements:l,outerSize:o,scrollOffset:e}){const s=l.length-1,i=ae(0,s,a=>l[a].start,e);let n=i;for(;n<s&&l[n].end<e+o;)n++;return{startIndex:i,endIndex:n}}const K=typeof document<"u"?d.useLayoutEffect:d.useEffect;function Ue(l){const o=d.useReducer(()=>({}),{})[1],e={...l,onChange:(t,i)=>{var n;i?fe.flushSync(o):o(),(n=l.onChange)==null||n.call(l,t,i)}},[s]=d.useState(()=>new Be(e));return s.setOptions(e),K(()=>s._didMount(),[]),K(()=>s._willUpdate()),s}function He(l){return Ue({observeElementRect:De,observeElementOffset:Ve,scrollToFn:Pe,...l})}const U={bybit:{src:"https://s2.coinmarketcap.com/static/img/exchanges/64x64/521.png",fallback:"By"},binance:{src:"https://s2.coinmarketcap.com/static/img/exchanges/64x64/270.png",fallback:"Bi"},bitget:{src:"https://s2.coinmarketcap.com/static/img/exchanges/64x64/513.png",fallback:"Bg"}},qe=({tickers:l,favorites:o=[],onToggleFavorite:e})=>{const{t:s}=R(),t=ge(),i=d.useRef(null),[n,a]=d.useState(3),[c,u]=d.useState(140);d.useEffect(()=>{const h=()=>{window.innerWidth<400?a(1):window.innerWidth<1024?a(2):a(3),window.innerHeight<800?u(120):window.innerHeight<1e3?u(130):u(140)};return h(),window.addEventListener("resize",h),()=>window.removeEventListener("resize",h)},[]);const m=d.useCallback(h=>h.split(":")[0].replace(/^[0-9]+/,""),[]),p=d.useMemo(()=>{const h=[];for(let f=0;f<l.length;f+=n){const M=l.slice(f,f+n);h.push(M)}return h},[l,n]),b=He({count:p.length,getScrollElement:()=>i.current,estimateSize:()=>c,overscan:5}),v=d.useCallback(h=>{var I,k;const f=`${h.exchange}-${h.symbol}`,M=o.includes(f);return r.jsx("div",{className:"p-1 sm:p-2 w-full",style:{flex:`0 0 calc(100% / ${n})`},children:r.jsx(q,{className:"cursor-pointer hover:border-primary/50 transition-colors duration-150 h-full flex flex-col",onClick:()=>{const O=encodeURIComponent(h.symbol);t(`/trade?exchange=${h.exchange}&symbol=${O}`)},children:r.jsxs(G,{className:"p-2 sm:p-3 flex flex-col h-full",children:[r.jsxs("div",{className:"flex flex-col mb-2",children:[r.jsxs("div",{className:"flex justify-between items-center mb-1",children:[r.jsxs("div",{className:"flex items-center",children:[r.jsxs(re,{className:"w-5 h-5 h-lg:w-6 h-lg:h-6 mr-1",children:[r.jsx(ie,{src:(I=U[h.exchange])==null?void 0:I.src,alt:s(`search.${h.exchange}`)}),r.jsx(le,{children:(k=U[h.exchange])==null?void 0:k.fallback})]}),r.jsx("span",{className:"font-medium text-xs h-lg:text-sm capitalize",children:s(`search.${h.exchange}`)})]}),e&&r.jsx("button",{onClick:O=>{O.stopPropagation(),e(h)},className:"text-yellow-500 hover:text-yellow-300 flex-shrink-0 p-1 -m-1","aria-label":s(M?"search.remove_from_favorites":"search.add_to_favorites"),children:r.jsx(Oe,{fill:M?"currentColor":"none",size:16,className:"transition-all"})})]}),r.jsx("div",{className:"font-semibold text-sm h-lg:text-base break-words",children:m(h.symbol)})]}),r.jsx("div",{className:"flex-grow"}),r.jsxs("div",{className:"flex justify-between mt-2",children:[r.jsxs("div",{className:"flex flex-col",children:[r.jsx("span",{className:"text-xs text-muted-foreground",children:s("search.volume")}),r.jsx("span",{className:"font-medium text-xs h-lg:text-sm truncate max-w-[60px] sm:max-w-none",children:xe(h.baseVolume)})]}),r.jsxs("div",{className:"flex flex-col items-end",children:[r.jsx("span",{className:"text-xs text-muted-foreground",children:s("search.price")}),r.jsx("span",{className:"font-medium text-xs h-lg:text-sm truncate max-w-[60px] sm:max-w-none",children:h.last})]})]})]})})},f)},[t,m,e,o,n,s]),y=d.useCallback(h=>r.jsx("div",{className:"p-1 sm:p-2",style:{flex:`0 0 calc(100% / ${n})`}},`empty-${h}`),[n]),E=d.useCallback(h=>{const f=p[h.index];return r.jsxs("div",{style:{position:"absolute",top:0,left:0,width:"100%",height:`${c}px`,transform:`translateY(${h.start}px)`},className:"flex w-full",children:[f.map(v),f.length<n&&Array.from({length:n-f.length}).map((M,I)=>y(I))]},`row-${h.index}`)},[p,c,v,y,n]);return r.jsxs("div",{ref:i,className:"overflow-auto scrollbar-thin scrollbar-thumb-border scrollbar-track-background h-[calc(100vh-10rem)] pb-10",children:[r.jsx("div",{style:{height:`${b.getTotalSize()}px`,width:"100%",position:"relative"},children:b.getVirtualItems().map(h=>E(h))}),l.length===0&&r.jsx("div",{className:"flex items-center justify-center h-40",children:r.jsx("p",{className:"text-muted-foreground",children:s("search.no_results")})})]})},Ge={ICON:{SM:"h-4 w-4"}},Je=({itemCount:l=30})=>{const[o,e]=d.useState(3);d.useEffect(()=>{const n=()=>{window.innerWidth<400?e(1):window.innerWidth<1024?e(2):e(3)};return n(),window.addEventListener("resize",n),()=>window.removeEventListener("resize",n)},[]);const s=d.useMemo(()=>{const n=[];for(let a=0;a<l;a+=o){const c=Array.from({length:Math.min(o,l-a)}).map((u,m)=>a+m);n.push(c)}return n},[l,o]),t=n=>r.jsx("div",{className:"p-1 sm:p-2",style:{flex:`0 0 calc(100% / ${o})`},children:r.jsx(q,{className:"h-full",children:r.jsxs(G,{className:"p-2 sm:p-3 flex flex-col h-full",children:[r.jsxs("div",{className:"flex items-center justify-between mb-2",children:[r.jsxs("div",{className:"flex items-center",children:[r.jsx(N,{className:Ge.ICON.SM}),r.jsx(N,{className:"ml-2 w-16 h-4 hidden sm:block"})]}),r.jsx(N,{className:"w-20 h-5"})]}),r.jsx("div",{className:"flex-grow my-3"}),r.jsxs("div",{className:"flex justify-between mt-2",children:[r.jsxs("div",{className:"flex flex-col",children:[r.jsx(N,{className:"w-12 h-3 mb-1"}),r.jsx(N,{className:"w-16 h-4 max-w-[60px] sm:max-w-none"})]}),r.jsxs("div",{className:"flex flex-col items-end",children:[r.jsx(N,{className:"w-10 h-3 mb-1"}),r.jsx(N,{className:"w-14 h-4 max-w-[60px] sm:max-w-none"})]})]})]})})},n),i=(n,a)=>r.jsx("div",{style:{flex:`0 0 calc(100% / ${o})`},className:"p-1 sm:p-2"},`empty-${n}-${a}`);return r.jsx("div",{className:"overflow-auto scrollbar-thin scrollbar-thumb-border scrollbar-track-background h-[calc(100vh-10rem)]","aria-busy":"true","aria-live":"polite",children:r.jsx("div",{className:"w-full",children:s.map((n,a)=>r.jsxs("div",{className:"flex w-full",children:[n.map(t),n.length<o&&Array.from({length:o-n.length}).map((c,u)=>i(a,u))]},`row-${a}`))})})},Qe=({sortConfig:l,onSort:o,showFavorites:e,onFavoriteFilter:s})=>{const{t}=R(),i=({labelKey:n,sortKey:a})=>r.jsxs("button",{onClick:()=>o(a),className:"flex items-center justify-center text-xs h-lg:text-sm",children:[t(n),l.key===a?l.direction==="asc"?r.jsx(ze,{className:"ml-1 w-3 h-3 h-lg:w-4 h-lg:h-4"}):r.jsx(Me,{className:"ml-1 w-3 h-3 h-lg:w-4 h-lg:h-4"}):r.jsx(Ie,{className:"ml-1 w-3 h-3 h-lg:w-4 h-lg:h-4"})]});return r.jsxs("div",{className:"flex justify-between items-center space-x-4 p-2 bg-background border-b",children:[r.jsx(Ne,{defaultValue:e?"favorites":"all",className:"h-6 h-lg:h-8 h-xl:h-10",onValueChange:n=>s(n==="favorites"),children:r.jsxs(Ee,{children:[r.jsx(W,{value:"all",children:t("search.all")}),r.jsx(W,{value:"favorites",children:t("search.favorites")})]})}),r.jsxs("div",{className:"flex space-x-4",children:[r.jsx(i,{labelKey:"search.symbol",sortKey:"symbol"}),r.jsx(i,{labelKey:"search.volume",sortKey:"baseVolume"}),r.jsx(i,{labelKey:"search.price",sortKey:"last"})]})]})},Xe=()=>r.jsxs("div",{className:"flex justify-between items-center space-x-4 p-2 bg-background border-b",children:[r.jsx(N,{className:"w-40 h-8"})," ",r.jsxs("div",{className:"flex space-x-4",children:[r.jsx(N,{className:"w-16 h-5"}),r.jsx(N,{className:"w-16 h-5"}),r.jsx(N,{className:"w-16 h-5"})]})]}),Ye=()=>{try{const l=localStorage.getItem("coin_favorites");return l?JSON.parse(l):[]}catch(l){return console.error("Failed to load favorites:",l),[]}},Ze=l=>{const o={bybit:l("search.bybit"),binance:l("search.binance"),bitget:l("search.bitget")},e=Object.fromEntries(Object.entries(o).map(([s,t])=>[t,s]));return{exchangeNameMap:o,reverseExchangeNameMap:e}},ct=()=>{const{t:l}=R(),{data:o,isLoading:e}=be(),[s,t]=d.useState([]),[i,n]=d.useState(""),[a,c]=d.useState(null),[u,m]=d.useState(!1),[p,b]=d.useState(Ye),[v,y]=d.useState({key:"baseVolume",direction:"desc"}),E=ve(),{exchangeNameMap:h,reverseExchangeNameMap:f}=d.useMemo(()=>Ze(l),[l]);d.useEffect(()=>{if(!o||e||!E)return;const g=o.map(x=>({...x,baseVolume:x.baseVolume*x.last,last:E[x.exchange].ccxt.priceToPrecision(x.symbol,x.last)}));t(g)},[o,e,E]);const M=d.useMemo(()=>s.filter(g=>{if(u){const x=`${g.exchange}-${g.symbol}`;if(!p.includes(x))return!1}if(a&&g.exchange!==a)return!1;if(i){const x=i.toLowerCase().split(/\s+/).filter(Boolean),w=[...Object.keys(h),...Object.values(h)],S=x.filter(C=>!w.includes(C)),j=x.find(C=>w.includes(C));if(j){const C=f[j]||j;if(g.exchange!==C)return!1}const T=String(g.symbol).toLowerCase();return S.every(C=>{const A=C.split("/");return A.length>1?A.every(he=>T.includes(he)):T.includes(C)})}return!0}).sort((g,x)=>{const{key:w,direction:S}=v;if(w==="symbol"){const C=String(g[w]).toLowerCase().replace(/^[0-9]+/,""),A=String(x[w]).toLowerCase().replace(/^[0-9]+/,"");return S==="asc"?C.localeCompare(A):A.localeCompare(C)}const j=g[w]||0,T=x[w]||0;return S==="asc"?j-T:T-j}),[s,u,p,a,i,v]),I=g=>{m(g)},k=g=>{const x=`${g.exchange}-${g.symbol}`,w=p.includes(x)?p.filter(S=>S!==x):[...p,x];b(w),setTimeout(()=>{try{localStorage.setItem("coin_favorites",JSON.stringify(w))}catch(S){console.error("Failed to save favorites:",S)}},0)},O=g=>{n(g);const x=g.toLowerCase().split(/\s+/).filter(Boolean),w=[...Object.keys(h),...Object.values(h)],S=x.find(j=>w.includes(j));if(S){const j=f[S]||S;a!==j&&c(j)}},oe=g=>{c(g)},ce=g=>{y(x=>({key:g,direction:x.key===g&&x.direction==="desc"?"asc":"desc"}))};return r.jsxs(pe,{headerProps:{title:l("common.search")},children:[r.jsx(Te,{onSearch:O,onExchangeFilter:oe,searchQuery:i,exchangeFilter:a}),e?r.jsxs(r.Fragment,{children:[r.jsx(Xe,{}),r.jsx(Je,{})]}):r.jsxs(r.Fragment,{children:[r.jsx(Qe,{sortConfig:v,onSort:ce,showFavorites:u,onFavoriteFilter:I}),r.jsx(qe,{tickers:M,favorites:p,onToggleFavorite:k})]})]})};export{ct as default};
