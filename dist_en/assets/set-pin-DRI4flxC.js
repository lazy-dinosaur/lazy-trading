import{b as I,d as z,r as m,e as E,a as L,j as e,T as G,f as O,g as R,B as d,h as B,X as q,V as l}from"./index--mJaizsc.js";import{u as D,F as K,a as X,b as H,c as J,d as Q}from"./form-CnYccCye.js";import{G as U,m as o,A as W,I as Y,a as h,b as u,L as Z,c as ee}from"./proxy-D7BGffrU.js";import{z as v,A as te,a as se,b as ae,t as re}from"./alert-Fao-om9Q.js";import{C as ne,a as ie}from"./card-BfKKBDHD.js";import{C as ce}from"./circle-alert-CnXNsqva.js";import{R as le}from"./refresh-cw-wChuhh6Z.js";import{A as oe}from"./arrow-left-CNAqUfmD.js";import{C as me}from"./circle-check-big-DlXXzgVz.js";import"./label-DparRnXT.js";/**
 * @license lucide-react v0.469.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const de=I("Fingerprint",[["path",{d:"M12 10a2 2 0 0 0-2 2c0 1.02-.1 2.51-.26 4",key:"1nerag"}],["path",{d:"M14 13.12c0 2.38 0 6.38-1 8.88",key:"o46ks0"}],["path",{d:"M17.29 21.02c.12-.6.43-2.3.5-3.02",key:"ptglia"}],["path",{d:"M2 12a10 10 0 0 1 18-6",key:"ydlgp0"}],["path",{d:"M2 16h.01",key:"1gqxmh"}],["path",{d:"M21.8 16c.2-2 .131-5.354 0-6",key:"drycrb"}],["path",{d:"M5 19.5C5.5 18 6 15 6 12a6 6 0 0 1 .34-2",key:"1tidbn"}],["path",{d:"M8.65 22c.21-.66.45-1.32.57-2",key:"13wd9y"}],["path",{d:"M9 6.8a6 6 0 0 1 9 5.2v2",key:"1fr1j5"}]]);/**
 * @license lucide-react v0.469.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const he=I("ShieldCheck",[["path",{d:"M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z",key:"oel41y"}],["path",{d:"m9 12 2 2 4-4",key:"dzmm74"}]]),ue=[[1,2,3],[4,5,6],[7,8,9],["clear",0,"delete"]],ve=()=>{const{t:s}=z(),[P,x]=m.useState(""),[n,p]=m.useState("create"),[b,g]=m.useState(0),[j,k]=m.useState(!1),[C,w]=m.useState(!1),[c,_]=m.useState("weak"),{setPin:S}=E(),T=L(),A=v.object({pin:v.string().min(4,s("auth.pin_must_be_4_digits","PINì€ 4ìë¦¬ì—¬ì•¼ í•©ë‹ˆë‹¤")).max(4,s("auth.pin_must_be_4_digits","PINì€ 4ìë¦¬ì—¬ì•¼ í•©ë‹ˆë‹¤")).regex(/^[0-9]+$/,s("auth.numbers_only","ìˆ«ìë§Œ ì…ë ¥ ê°€ëŠ¥í•©ë‹ˆë‹¤"))}),$=t=>{if(!t||t.length<4)return"weak";const r=parseInt(t[0])+1===parseInt(t[1])&&parseInt(t[1])+1===parseInt(t[2])&&parseInt(t[2])+1===parseInt(t[3])||parseInt(t[0])-1===parseInt(t[1])&&parseInt(t[1])-1===parseInt(t[2])&&parseInt(t[2])-1===parseInt(t[3]),i=t[0]===t[1]&&t[1]===t[2]&&t[2]===t[3],y=t[0]===t[1]&&t[2]===t[3];return r||i?"weak":y?"medium":"strong"},f={weak:"bg-red-500",medium:"bg-yellow-500",strong:"bg-green-500"},M={weak:s("auth.strength_weak","ì·¨ì•½"),medium:s("auth.strength_medium","ë³´í†µ"),strong:s("auth.strength_strong","ê°•ë ¥")},a=D({resolver:re(A),defaultValues:{pin:""}});m.useEffect(()=>{if(n==="create"){const t=a.watch("pin");t.length===4?_($(t)):_("weak")}},[a.watch("pin"),n]);const N=async t=>{if(n==="create")x(t.pin),p("confirm"),a.reset(),l.success(s("auth.pin_entered_confirm","PINì´ ì…ë ¥ë˜ì—ˆìŠµë‹ˆë‹¤. í™•ì¸ì„ ìœ„í•´ í•œë²ˆ ë” ì…ë ¥í•´ì£¼ì„¸ìš”."),{icon:"ğŸ”",duration:2e3});else if(t.pin===P){console.log("PIN confirmed:",t.pin),l.loading(s("auth.setting_pin","PINì„ ì„¤ì • ì¤‘ì…ë‹ˆë‹¤..."));try{await S(t.pin)&&(l.dismiss(),l.success(s("auth.pin_set_successfully","PINì´ ì„±ê³µì ìœ¼ë¡œ ì„¤ì •ë˜ì—ˆìŠµë‹ˆë‹¤!"),{icon:"âœ…",duration:2e3}),T("/dashboard",{replace:!0}))}catch(r){l.dismiss(),l.error(s("auth.error_setting_pin","PIN ì„¤ì • ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤")),console.error("PIN ì„¤ì • ì˜¤ë¥˜:",r)}}else{w(!0),setTimeout(()=>w(!1),500);const r=b+1;g(r),r>=5?(l.error(s("auth.too_many_attempts","ì…ë ¥ ì‹œë„ íšŸìˆ˜ ì´ˆê³¼! PIN ì„¤ì •ì„ ì²˜ìŒë¶€í„° ë‹¤ì‹œ ì‹œì‘í•©ë‹ˆë‹¤.")),p("create"),x(""),g(0),a.reset(),a.setError("pin",{type:"manual",message:s("auth.attempts_exceeded_reset","ì‹œë„ íšŸìˆ˜ë¥¼ ì´ˆê³¼í–ˆìŠµë‹ˆë‹¤. PINì„ ë‹¤ì‹œ ì„¤ì •í•´ì£¼ì„¸ìš”.")})):(a.reset(),l.error(s("auth.pin_mismatch_attempts_remaining","PINì´ ì¼ì¹˜í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤. ë‚¨ì€ ì‹œë„ íšŸìˆ˜: {{count}}íšŒ",{count:5-r})),a.setError("pin",{type:"manual",message:s("auth.pin_mismatch_attempts_remaining","PINì´ ì¼ì¹˜í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤. ë‚¨ì€ ì‹œë„ íšŸìˆ˜: {{count}}íšŒ",{count:5-r})}))}};m.useEffect(()=>{a.watch("pin").length===4&&a.handleSubmit(N)()},[a.watch("pin")]);const F=t=>{const r=a.getValues("pin");t==="clear"?a.setValue("pin",""):t==="delete"?a.setValue("pin",r.slice(0,-1)):typeof t=="number"&&r.length<4&&a.setValue("pin",r+t)},V=()=>{window.open("https://github.com/lazy-dinosaur","_blank")};return e.jsxs("div",{className:"min-h-screen bg-background flex flex-col items-center justify-center p-4",children:[e.jsxs("div",{className:"mb-8 text-center",children:[e.jsx("h1",{className:"text-4xl font-bold text-primary mb-2",children:"LazyTrading"}),e.jsxs("div",{className:"flex items-center justify-center gap-1 text-sm text-muted-foreground",children:[e.jsx("span",{children:"by"}),e.jsxs("button",{onClick:V,className:"flex items-center gap-1 hover:text-primary transition-colors",children:["lazy-dinosaur",e.jsx(U,{className:"h-3 w-3"})]})]})]}),e.jsx(ne,{className:"w-full max-w-md shadow-lg border-2",children:e.jsxs(ie,{className:"p-6",children:[e.jsx("div",{className:"flex justify-center mb-6",children:e.jsx(o.div,{initial:{scale:.8,rotate:-10},animate:{scale:1,rotate:0},className:"w-20 h-20 bg-primary/10 flex items-center justify-center rounded-full",children:e.jsx(de,{className:"h-10 w-10 text-primary"})})}),e.jsx(W,{mode:"wait",children:e.jsxs(o.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},exit:{opacity:0,y:-10},transition:{duration:.3},className:"text-center mb-6",children:[e.jsx("h1",{className:"text-2xl font-bold",children:s(n==="create"?"auth.create_pin":"auth.confirm_pin")}),e.jsx("p",{className:"text-muted-foreground mt-2",children:n==="create"?s("auth.set_4_digit_pin","ê³„ì •ê³¼ API í‚¤ë¥¼ ë³´í˜¸í•˜ê¸° ìœ„í•œ 4ìë¦¬ PINì„ ì„¤ì •í•˜ì„¸ìš”"):s("auth.enter_pin_again","PINì„ ë‹¤ì‹œ í•œë²ˆ ì…ë ¥í•˜ì—¬ í™•ì¸í•´ì£¼ì„¸ìš” (ë‚¨ì€ ì‹œë„: {{count}}íšŒ)",{count:5-b})})]},n)}),n==="create"&&e.jsxs(te,{className:"mb-6 border-primary/20 bg-primary/5",children:[e.jsx(he,{className:"h-4 w-4 text-primary"}),e.jsx(se,{children:s("auth.security_note","ë³´ì•ˆ ì•ˆë‚´")}),e.jsx(ae,{className:"text-xs",children:s("auth.pin_security_note","PINì€ API í‚¤ë¥¼ ì•ˆì „í•˜ê²Œ ì•”í˜¸í™”í•˜ëŠ” ë° ì‚¬ìš©ë©ë‹ˆë‹¤. PINì„ ìŠì–´ë²„ë¦¬ë©´ ëª¨ë“  ë°ì´í„°ê°€ ì´ˆê¸°í™”ë©ë‹ˆë‹¤. ì•ˆì „í•œ ê³³ì— PINì„ ê¸°ë¡í•´ë‘ì„¸ìš”.")})]}),e.jsx(K,{...a,children:e.jsxs("form",{onSubmit:a.handleSubmit(N),className:"space-y-6",children:[e.jsx(X,{control:a.control,name:"pin",render:({field:t})=>e.jsxs(H,{className:"space-y-4",children:[e.jsx(J,{children:e.jsx(o.div,{animate:C?{x:[0,-10,10,-10,10,0]}:{},transition:{duration:.5},className:"w-full flex justify-center",children:e.jsxs(Y,{maxLength:4,value:t.value,onChange:r=>{const i=r.replace(/\D/g,"");t.onChange(i)},className:"flex justify-center gap-4",pattern:"[0-9]*",inputMode:"numeric",type:j?"text":"password",children:[e.jsx(h,{children:e.jsx(u,{index:0,className:`h-16 w-16 text-2xl border-2 ${t.value[0]?"border-primary":""}`})}),e.jsx(h,{children:e.jsx(u,{index:1,className:`h-16 w-16 text-2xl border-2 ${t.value[1]?"border-primary":""}`})}),e.jsx(h,{children:e.jsx(u,{index:2,className:`h-16 w-16 text-2xl border-2 ${t.value[2]?"border-primary":""}`})}),e.jsx(h,{children:e.jsx(u,{index:3,className:`h-16 w-16 text-2xl border-2 ${t.value[3]?"border-primary":""}`})})]})})}),n==="create"&&t.value.length===4&&e.jsxs(o.div,{initial:{opacity:0,height:0},animate:{opacity:1,height:"auto"},className:"flex items-center justify-center gap-2 mt-2",children:[e.jsxs("div",{className:"flex items-center space-x-1",children:[e.jsx("div",{className:`h-2 w-8 rounded-full ${c==="weak"?f.weak:"bg-gray-200"}`}),e.jsx("div",{className:`h-2 w-8 rounded-full ${c==="medium"||c==="strong"?f[c]:"bg-gray-200"}`}),e.jsx("div",{className:`h-2 w-8 rounded-full ${c==="strong"?f.strong:"bg-gray-200"}`})]}),e.jsx("span",{className:`text-xs ${c==="weak"?"text-red-500":c==="medium"?"text-yellow-500":"text-green-500"}`,children:s("auth.security_strength","ë³´ì•ˆ ê°•ë„: {{strength}}",{strength:M[c]})}),e.jsx(G,{children:e.jsxs(O,{children:[e.jsx(R,{asChild:!0,children:e.jsx(d,{variant:"ghost",size:"icon",className:"h-6 w-6 ml-1",children:e.jsx(ce,{className:"h-4 w-4"})})}),e.jsx(B,{className:"max-w-xs",children:e.jsx("p",{className:"text-xs",children:c==="weak"?s("auth.weak_pin_message","ì—°ì†ëœ ìˆ«ì(1234)ë‚˜ ë°˜ë³µëœ ìˆ«ì(1111)ëŠ” ì¶”ì¸¡í•˜ê¸° ì‰½ìŠµë‹ˆë‹¤."):c==="medium"?s("auth.medium_pin_message","ë” ì•ˆì „í•œ PINì„ ìœ„í•´ ë¬´ì‘ìœ„ ìˆ«ìë¥¼ ì‚¬ìš©í•˜ì„¸ìš”."):s("auth.strong_pin_message","ì¢‹ì€ PIN ì…ë‹ˆë‹¤! ìŠì§€ ë§ˆì„¸ìš”.")})})]})})]}),e.jsx("div",{className:"flex justify-center",children:e.jsx(d,{type:"button",variant:"ghost",size:"sm",onClick:()=>k(!j),className:"text-xs",children:j?e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx(Z,{className:"h-3 w-3"})," ",s("auth.hide_pin","PIN ìˆ¨ê¸°ê¸°")]}):e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx(ee,{className:"h-3 w-3"})," ",s("auth.show_pin","PIN í‘œì‹œí•˜ê¸°")]})})}),e.jsx(Q,{className:"text-center"})]})}),e.jsxs("div",{className:"mt-6 max-w-[280px] mx-auto",children:[" ",e.jsx("div",{className:"grid grid-cols-3 gap-3",children:ue.map((t,r)=>t.map((i,y)=>e.jsx(o.div,{whileTap:{scale:.95},children:e.jsx(d,{type:"button",variant:i==="clear"||i==="delete"?"outline":"secondary",size:"lg",className:`h-14 w-14 text-xl font-semibold ${typeof i=="number"?"hover:bg-primary hover:text-primary-foreground":""}`,onClick:()=>F(i),children:i==="clear"?e.jsx(le,{className:"h-5 w-5"}):i==="delete"?e.jsx(q,{className:"h-5 w-5"}):i})},`${r}-${y}`)))})]}),e.jsxs("div",{className:"flex justify-between pt-4",children:[n==="confirm"&&e.jsx(o.div,{initial:{opacity:0,x:-20},animate:{opacity:1,x:0},children:e.jsxs(d,{type:"button",variant:"outline",onClick:()=>{l(s("auth.going_back","ì´ì „ ë‹¨ê³„ë¡œ ëŒì•„ê°‘ë‹ˆë‹¤"),{icon:"â¬…ï¸",duration:1500}),p("create"),x(""),g(0),a.reset()},className:"flex items-center gap-2",children:[e.jsx(oe,{className:"h-4 w-4"}),s("auth.previous_step","ì´ì „ ë‹¨ê³„")]})}),n==="create"&&a.watch("pin").length===4&&e.jsx(o.div,{initial:{opacity:0},animate:{opacity:1},className:"ml-auto",children:e.jsxs(d,{type:"button",onClick:a.handleSubmit(N),className:"flex items-center gap-2",children:[s("auth.next_step","ë‹¤ìŒ ë‹¨ê³„"),e.jsx(me,{className:"h-4 w-4"})]})})]})]})})]})}),e.jsxs("div",{className:"flex items-center gap-2 mt-6",children:[e.jsx(o.div,{animate:{backgroundColor:n==="create"?"var(--primary)":"var(--muted)"},className:"h-2 w-10 rounded-full"}),e.jsx(o.div,{animate:{backgroundColor:n==="confirm"?"var(--primary)":"var(--muted)"},className:"h-2 w-10 rounded-full"})]}),e.jsxs("p",{className:"text-xs text-muted-foreground mt-4 text-center",children:[s("auth.pin_security_message","PINì€ API í‚¤ë¥¼ ì•ˆì „í•˜ê²Œ ë³´í˜¸í•˜ëŠ” ë° ì‚¬ìš©ë©ë‹ˆë‹¤."),e.jsx("br",{}),s("auth.pin_reset_message","PINì„ ìŠì–´ë²„ë¦° ê²½ìš° ëª¨ë“  ê³„ì • ë°ì´í„°ë¥¼ ìƒˆë¡œ ì„¤ì •í•´ì•¼ í•©ë‹ˆë‹¤.")]})]})};export{ve as default};
