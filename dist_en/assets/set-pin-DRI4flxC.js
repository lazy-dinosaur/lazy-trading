import{b as I,d as z,r as m,e as E,a as L,j as e,T as G,f as O,g as R,B as d,h as B,X as q,V as l}from"./index--mJaizsc.js";import{u as D,F as K,a as X,b as H,c as J,d as Q}from"./form-CnYccCye.js";import{G as U,m as o,A as W,I as Y,a as h,b as u,L as Z,c as ee}from"./proxy-D7BGffrU.js";import{z as v,A as te,a as se,b as ae,t as re}from"./alert-Fao-om9Q.js";import{C as ne,a as ie}from"./card-BfKKBDHD.js";import{C as ce}from"./circle-alert-CnXNsqva.js";import{R as le}from"./refresh-cw-wChuhh6Z.js";import{A as oe}from"./arrow-left-CNAqUfmD.js";import{C as me}from"./circle-check-big-DlXXzgVz.js";import"./label-DparRnXT.js";/**
 * @license lucide-react v0.469.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const de=I("Fingerprint",[["path",{d:"M12 10a2 2 0 0 0-2 2c0 1.02-.1 2.51-.26 4",key:"1nerag"}],["path",{d:"M14 13.12c0 2.38 0 6.38-1 8.88",key:"o46ks0"}],["path",{d:"M17.29 21.02c.12-.6.43-2.3.5-3.02",key:"ptglia"}],["path",{d:"M2 12a10 10 0 0 1 18-6",key:"ydlgp0"}],["path",{d:"M2 16h.01",key:"1gqxmh"}],["path",{d:"M21.8 16c.2-2 .131-5.354 0-6",key:"drycrb"}],["path",{d:"M5 19.5C5.5 18 6 15 6 12a6 6 0 0 1 .34-2",key:"1tidbn"}],["path",{d:"M8.65 22c.21-.66.45-1.32.57-2",key:"13wd9y"}],["path",{d:"M9 6.8a6 6 0 0 1 9 5.2v2",key:"1fr1j5"}]]);/**
 * @license lucide-react v0.469.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const he=I("ShieldCheck",[["path",{d:"M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z",key:"oel41y"}],["path",{d:"m9 12 2 2 4-4",key:"dzmm74"}]]),ue=[[1,2,3],[4,5,6],[7,8,9],["clear",0,"delete"]],ve=()=>{const{t:s}=z(),[P,x]=m.useState(""),[n,p]=m.useState("create"),[b,g]=m.useState(0),[j,k]=m.useState(!1),[C,w]=m.useState(!1),[c,_]=m.useState("weak"),{setPin:S}=E(),T=L(),A=v.object({pin:v.string().min(4,s("auth.pin_must_be_4_digits","PIN은 4자리여야 합니다")).max(4,s("auth.pin_must_be_4_digits","PIN은 4자리여야 합니다")).regex(/^[0-9]+$/,s("auth.numbers_only","숫자만 입력 가능합니다"))}),$=t=>{if(!t||t.length<4)return"weak";const r=parseInt(t[0])+1===parseInt(t[1])&&parseInt(t[1])+1===parseInt(t[2])&&parseInt(t[2])+1===parseInt(t[3])||parseInt(t[0])-1===parseInt(t[1])&&parseInt(t[1])-1===parseInt(t[2])&&parseInt(t[2])-1===parseInt(t[3]),i=t[0]===t[1]&&t[1]===t[2]&&t[2]===t[3],y=t[0]===t[1]&&t[2]===t[3];return r||i?"weak":y?"medium":"strong"},f={weak:"bg-red-500",medium:"bg-yellow-500",strong:"bg-green-500"},M={weak:s("auth.strength_weak","취약"),medium:s("auth.strength_medium","보통"),strong:s("auth.strength_strong","강력")},a=D({resolver:re(A),defaultValues:{pin:""}});m.useEffect(()=>{if(n==="create"){const t=a.watch("pin");t.length===4?_($(t)):_("weak")}},[a.watch("pin"),n]);const N=async t=>{if(n==="create")x(t.pin),p("confirm"),a.reset(),l.success(s("auth.pin_entered_confirm","PIN이 입력되었습니다. 확인을 위해 한번 더 입력해주세요."),{icon:"🔐",duration:2e3});else if(t.pin===P){console.log("PIN confirmed:",t.pin),l.loading(s("auth.setting_pin","PIN을 설정 중입니다..."));try{await S(t.pin)&&(l.dismiss(),l.success(s("auth.pin_set_successfully","PIN이 성공적으로 설정되었습니다!"),{icon:"✅",duration:2e3}),T("/dashboard",{replace:!0}))}catch(r){l.dismiss(),l.error(s("auth.error_setting_pin","PIN 설정 중 오류가 발생했습니다")),console.error("PIN 설정 오류:",r)}}else{w(!0),setTimeout(()=>w(!1),500);const r=b+1;g(r),r>=5?(l.error(s("auth.too_many_attempts","입력 시도 횟수 초과! PIN 설정을 처음부터 다시 시작합니다.")),p("create"),x(""),g(0),a.reset(),a.setError("pin",{type:"manual",message:s("auth.attempts_exceeded_reset","시도 횟수를 초과했습니다. PIN을 다시 설정해주세요.")})):(a.reset(),l.error(s("auth.pin_mismatch_attempts_remaining","PIN이 일치하지 않습니다. 남은 시도 횟수: {{count}}회",{count:5-r})),a.setError("pin",{type:"manual",message:s("auth.pin_mismatch_attempts_remaining","PIN이 일치하지 않습니다. 남은 시도 횟수: {{count}}회",{count:5-r})}))}};m.useEffect(()=>{a.watch("pin").length===4&&a.handleSubmit(N)()},[a.watch("pin")]);const F=t=>{const r=a.getValues("pin");t==="clear"?a.setValue("pin",""):t==="delete"?a.setValue("pin",r.slice(0,-1)):typeof t=="number"&&r.length<4&&a.setValue("pin",r+t)},V=()=>{window.open("https://github.com/lazy-dinosaur","_blank")};return e.jsxs("div",{className:"min-h-screen bg-background flex flex-col items-center justify-center p-4",children:[e.jsxs("div",{className:"mb-8 text-center",children:[e.jsx("h1",{className:"text-4xl font-bold text-primary mb-2",children:"LazyTrading"}),e.jsxs("div",{className:"flex items-center justify-center gap-1 text-sm text-muted-foreground",children:[e.jsx("span",{children:"by"}),e.jsxs("button",{onClick:V,className:"flex items-center gap-1 hover:text-primary transition-colors",children:["lazy-dinosaur",e.jsx(U,{className:"h-3 w-3"})]})]})]}),e.jsx(ne,{className:"w-full max-w-md shadow-lg border-2",children:e.jsxs(ie,{className:"p-6",children:[e.jsx("div",{className:"flex justify-center mb-6",children:e.jsx(o.div,{initial:{scale:.8,rotate:-10},animate:{scale:1,rotate:0},className:"w-20 h-20 bg-primary/10 flex items-center justify-center rounded-full",children:e.jsx(de,{className:"h-10 w-10 text-primary"})})}),e.jsx(W,{mode:"wait",children:e.jsxs(o.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},exit:{opacity:0,y:-10},transition:{duration:.3},className:"text-center mb-6",children:[e.jsx("h1",{className:"text-2xl font-bold",children:s(n==="create"?"auth.create_pin":"auth.confirm_pin")}),e.jsx("p",{className:"text-muted-foreground mt-2",children:n==="create"?s("auth.set_4_digit_pin","계정과 API 키를 보호하기 위한 4자리 PIN을 설정하세요"):s("auth.enter_pin_again","PIN을 다시 한번 입력하여 확인해주세요 (남은 시도: {{count}}회)",{count:5-b})})]},n)}),n==="create"&&e.jsxs(te,{className:"mb-6 border-primary/20 bg-primary/5",children:[e.jsx(he,{className:"h-4 w-4 text-primary"}),e.jsx(se,{children:s("auth.security_note","보안 안내")}),e.jsx(ae,{className:"text-xs",children:s("auth.pin_security_note","PIN은 API 키를 안전하게 암호화하는 데 사용됩니다. PIN을 잊어버리면 모든 데이터가 초기화됩니다. 안전한 곳에 PIN을 기록해두세요.")})]}),e.jsx(K,{...a,children:e.jsxs("form",{onSubmit:a.handleSubmit(N),className:"space-y-6",children:[e.jsx(X,{control:a.control,name:"pin",render:({field:t})=>e.jsxs(H,{className:"space-y-4",children:[e.jsx(J,{children:e.jsx(o.div,{animate:C?{x:[0,-10,10,-10,10,0]}:{},transition:{duration:.5},className:"w-full flex justify-center",children:e.jsxs(Y,{maxLength:4,value:t.value,onChange:r=>{const i=r.replace(/\D/g,"");t.onChange(i)},className:"flex justify-center gap-4",pattern:"[0-9]*",inputMode:"numeric",type:j?"text":"password",children:[e.jsx(h,{children:e.jsx(u,{index:0,className:`h-16 w-16 text-2xl border-2 ${t.value[0]?"border-primary":""}`})}),e.jsx(h,{children:e.jsx(u,{index:1,className:`h-16 w-16 text-2xl border-2 ${t.value[1]?"border-primary":""}`})}),e.jsx(h,{children:e.jsx(u,{index:2,className:`h-16 w-16 text-2xl border-2 ${t.value[2]?"border-primary":""}`})}),e.jsx(h,{children:e.jsx(u,{index:3,className:`h-16 w-16 text-2xl border-2 ${t.value[3]?"border-primary":""}`})})]})})}),n==="create"&&t.value.length===4&&e.jsxs(o.div,{initial:{opacity:0,height:0},animate:{opacity:1,height:"auto"},className:"flex items-center justify-center gap-2 mt-2",children:[e.jsxs("div",{className:"flex items-center space-x-1",children:[e.jsx("div",{className:`h-2 w-8 rounded-full ${c==="weak"?f.weak:"bg-gray-200"}`}),e.jsx("div",{className:`h-2 w-8 rounded-full ${c==="medium"||c==="strong"?f[c]:"bg-gray-200"}`}),e.jsx("div",{className:`h-2 w-8 rounded-full ${c==="strong"?f.strong:"bg-gray-200"}`})]}),e.jsx("span",{className:`text-xs ${c==="weak"?"text-red-500":c==="medium"?"text-yellow-500":"text-green-500"}`,children:s("auth.security_strength","보안 강도: {{strength}}",{strength:M[c]})}),e.jsx(G,{children:e.jsxs(O,{children:[e.jsx(R,{asChild:!0,children:e.jsx(d,{variant:"ghost",size:"icon",className:"h-6 w-6 ml-1",children:e.jsx(ce,{className:"h-4 w-4"})})}),e.jsx(B,{className:"max-w-xs",children:e.jsx("p",{className:"text-xs",children:c==="weak"?s("auth.weak_pin_message","연속된 숫자(1234)나 반복된 숫자(1111)는 추측하기 쉽습니다."):c==="medium"?s("auth.medium_pin_message","더 안전한 PIN을 위해 무작위 숫자를 사용하세요."):s("auth.strong_pin_message","좋은 PIN 입니다! 잊지 마세요.")})})]})})]}),e.jsx("div",{className:"flex justify-center",children:e.jsx(d,{type:"button",variant:"ghost",size:"sm",onClick:()=>k(!j),className:"text-xs",children:j?e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx(Z,{className:"h-3 w-3"})," ",s("auth.hide_pin","PIN 숨기기")]}):e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx(ee,{className:"h-3 w-3"})," ",s("auth.show_pin","PIN 표시하기")]})})}),e.jsx(Q,{className:"text-center"})]})}),e.jsxs("div",{className:"mt-6 max-w-[280px] mx-auto",children:[" ",e.jsx("div",{className:"grid grid-cols-3 gap-3",children:ue.map((t,r)=>t.map((i,y)=>e.jsx(o.div,{whileTap:{scale:.95},children:e.jsx(d,{type:"button",variant:i==="clear"||i==="delete"?"outline":"secondary",size:"lg",className:`h-14 w-14 text-xl font-semibold ${typeof i=="number"?"hover:bg-primary hover:text-primary-foreground":""}`,onClick:()=>F(i),children:i==="clear"?e.jsx(le,{className:"h-5 w-5"}):i==="delete"?e.jsx(q,{className:"h-5 w-5"}):i})},`${r}-${y}`)))})]}),e.jsxs("div",{className:"flex justify-between pt-4",children:[n==="confirm"&&e.jsx(o.div,{initial:{opacity:0,x:-20},animate:{opacity:1,x:0},children:e.jsxs(d,{type:"button",variant:"outline",onClick:()=>{l(s("auth.going_back","이전 단계로 돌아갑니다"),{icon:"⬅️",duration:1500}),p("create"),x(""),g(0),a.reset()},className:"flex items-center gap-2",children:[e.jsx(oe,{className:"h-4 w-4"}),s("auth.previous_step","이전 단계")]})}),n==="create"&&a.watch("pin").length===4&&e.jsx(o.div,{initial:{opacity:0},animate:{opacity:1},className:"ml-auto",children:e.jsxs(d,{type:"button",onClick:a.handleSubmit(N),className:"flex items-center gap-2",children:[s("auth.next_step","다음 단계"),e.jsx(me,{className:"h-4 w-4"})]})})]})]})})]})}),e.jsxs("div",{className:"flex items-center gap-2 mt-6",children:[e.jsx(o.div,{animate:{backgroundColor:n==="create"?"var(--primary)":"var(--muted)"},className:"h-2 w-10 rounded-full"}),e.jsx(o.div,{animate:{backgroundColor:n==="confirm"?"var(--primary)":"var(--muted)"},className:"h-2 w-10 rounded-full"})]}),e.jsxs("p",{className:"text-xs text-muted-foreground mt-4 text-center",children:[s("auth.pin_security_message","PIN은 API 키를 안전하게 보호하는 데 사용됩니다."),e.jsx("br",{}),s("auth.pin_reset_message","PIN을 잊어버린 경우 모든 계정 데이터를 새로 설정해야 합니다.")]})]})};export{ve as default};
